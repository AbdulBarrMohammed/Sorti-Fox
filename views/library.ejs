<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/indexStyles.css">
    <link rel="stylesheet" href="/libraryStyle.css">
    <title>Document</title>
</head>
<body>
    <% if (user) {%>
        <header class="header">
            <div class="left-header">
                <a href="/">
                    <img src="/images/fox-4-svgrepo-com.svg">
                    <h2>SortiFox</h2>
                </a>
                <ul class="left-header-left-links">
                    <li><a href="">Products</a></li>
                    <li><a href="">Solutions</a></li>
                    <li><a href="">Enterprise</a></li>
                    <li><a href="">App</a></li>
                </ul>
            </div>
            <div class="right-header">
                <ul>
                    <li><a href="/log-out">Log out</a></li>
                    <li><div class="profile"> <p><%- user.email.charAt(0).toUpperCase() %></p> </div></li>

                </ul>
            </div>
        </header>
    <% } else { %>
        <%- include('./header.ejs') %>
    <%}%>


    <div class="library-container">

        <div class="sidebar">
            <div class="sidebar-top">
                    <h2>My Files</h2>
            </div>
            <ul>
                <li>
                    <div class="library-links">
                        <img src="/images/file-outline.svg"/>
                        <a>Files</a>
                    </div>
                </li>
                <li>
                    <div class="library-links">
                        <img src="/images/downloadBtn.svg"/>
                        <a>Downloaded files</a>
                    </div>
                </li>
                <li>
                    <div class="library-links">
                        <img src="/images/star-outline.svg"/>
                        <a>Starred files</a>
                    </div>
                </li>
                <li>
                    <div class="library-links">
                        <img src="/images/share-variant.svg"/>
                        <a>Shared files</a>
                    </div>
                </li>
                <li>
                    <div class="library-links">
                        <img src="/images/trash.svg"/>
                        <a>Deleted files</a>
                    </div>
                </li>


            </ul>
        </div>
        <div class="library-files-container">
            <div class="library-header-buttons">
                    <div class="button-container" id="open-modal">
                        <img src="/images/plus.svg">
                        <p>Create folder</p>
                    </div>

                <div id="myModal" class="modal">
                    <div class="modal-content">
                        <span class="close">&times;</span>
                        <h2>Create Folder</h2>
                        <form action="/library/create" method="POST">
                            <label for="folder-name">Folder Name:</label>
                            <input type="text" id="folderName" name="folderName" required>
                            <button type="submit">Create</button>
                        </form>
                    </div>
                </div>
                <a>
                    <div class="button-container upload">
                        <img src="/images/upload.svg">
                        <p>Upload file</p>
                    </div>

                </a>


            </div>
            <h2>All Files</h2>

            <section class="table__body">
                <table>
                    <thead>
                        <tr>
                            <th> Name </th>
                            <th> Size </th>
                            <th> Created </th>
                            <th> Last Updated </th>
                            <th> Options </th>
                        </tr>
                    </thead>
                    <tbody>
                        <% function displayTimeAgo(createdAt) { %>
                            <%= formatDistanceToNow(new Date(createdAt), { addSuffix: true }) %>
                          <% } %>
                        <% folders.map((folder, index) => { %>
                            <%

                            %>

                            <tr>
                                <td> <a>  <img src="/images/folder-outline.svg"> <%= folder.name %> </a> </td>
                                <td> - </td>
                                <td> <%= displayTimeAgo(folder.createdAt) %> </td>
                                <td> Yesterday </td>
                                <td> ... </td>
                            </tr>
                         <% }) %>
                        <tr>
                            <td> <a>  <img src="/images/folder-outline.svg"> New folder </a> </td>
                            <td> 56 Btyes </td>
                            <td> 2 days ago </td>
                            <td> Yesterday </td>
                            <td> ... </td>
                        </tr>
                        <tr>
                            <td> <a>  <img src="/images/folder-outline.svg"> New folder </a> </td>
                            <td> 56 Btyes </td>
                            <td> 2 days ago </td>
                            <td> Yesterday </td>
                            <td> ... </td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const modal = document.getElementById('myModal');
            const btn = document.getElementById('open-modal');
            const span = document.getElementsByClassName('close')[0];

            // Open the modal
            btn.onclick = function() {
                modal.style.display = 'block';
            }

            // Close the modal
            span.onclick = function() {
                modal.style.display = 'none';
            }

            // Close the modal when clicking outside of it
            window.onclick = function(event) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            }

            // Handle form submission
            document.getElementById('create-folder-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const folderName = document.getElementById('folder-name').value;
                console.log('Folder Name:', folderName);
                // Here you can add AJAX code to send the form data to the server
                modal.style.display = 'none'; // Close the modal after submission
            });
        });
        </script>

</body>
</html>
